% !TEX root = ../main.tex
%

\section{Moore-Penrose の一般化逆行列}

\index{Moore-Penroseのいっぱんかぎゃくぎょうれつ@Moore-Penrose の一般化逆行列}
\index{いっぱんかぎゃくぎょうれつ@一般化逆行列|see{Moore-Penrose の一般化逆行列}}
最小二乗法を理論的に扱う際に，
Moore-Penrose の一般化逆行列がしばしば使用される．
本資料でも使用するため，以下にその定義と性質を示す．

行列 $A \in \setC^{m \times n}$ と
ベクトル $\bm{y} \in \setC^m$ に対して，
次の最適化問題を考える．
\begin{align}
    \text{minimize} \hspace{2em} & \|\bm{x}\|_2
    \notag                                                                                          \\
    \text{s.t.} \hspace{2em}     & \|A\bm{x}-\bm{y}\|_2 =  \min_{\bm{x}} \{ \|A\bm{x}-\bm{y}\|_2 \}
    \notag
\end{align}

この最適化問題の解は $\bm{x}=G\bm{y}$ のように
ベクトル $\bm{y}$ に依らない行列
$G \in \setC^{n \times m}$ を用いて表せる．
この行列 $G$ を Moore-Penrose の一般化逆行列と呼び，
$A^\dagger$ で表す \cite[定義3]{Rao1971}．
$\|A \bm{x} - \bm{y}\|_2$ を最小化するだけでは
$A$ の核空間が $\bm{0}$ 以外の要素を持つ場合に解が 1 つに定まらないが，
$\|\bm{x}\|_2$ が最小となるものを選ぶことにより，
解が 1 つに定まる．
なお，定義から，$A^\dagger \bm{y}$ は $A$ の核空間の成分を持たないことが示せる．

行列 $A$ がランク $n$ の場合，
$\|A \bm{x} - \bm{y}\|_2$ を最小化する $\bm{x}$ は唯一であり，
Moore-Penrose の一般化逆行列を用いて
$\bm{x} = A^\dagger \bm{y}$ と表される．
さらに，一般の行列 $A$ においては，
任意のベクトル $z \in \setC^n$ を用いて
\begin{equation}
    \bm{x} = A^\dagger \bm{y} + (I - A^\dagger A) \bm{z}
    \label{eq:matrix-computation_moore-penrose_general-least-squares-solution}
\end{equation}
のように最小二乗解を表すことができる \cite[定理2.3.1]{Rao1971}．
なお，$I - A^\dagger A$ は $A$ の核空間への射影行列となっている．

Moore-Penrose の一般化逆行列は，
ランクが $m$ または $n$ の場合に通常の逆行列を用いて次のように表現できる．

\begin{itemize}
    \item $A \in \setC^{m \times n}$ がランク $m$ の場合
          \begin{equation}
              A^\dagger = A^* (A A^*)^{-1}
          \end{equation}
    \item $A \in \setC^{m \times n}$ がランク $n$ の場合
          \begin{equation}
              A^\dagger = (A^* A)^{-1} A^*
          \end{equation}
\end{itemize}
