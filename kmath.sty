\ProvidesPackage{kmath}

\RequirePackage{amsmath}

\newif\ifkmath@book
\kmath@bookfalse
\DeclareOption{book}{\kmath@booktrue}

\newif\ifkmath@many
\kmath@manyfalse
\DeclareOption{many}{\kmath@manytrue}

\newif\ifkmath@amsthm
\kmath@amsthmfalse
\DeclareOption{amsthm}{\kmath@amsthmtrue}
\ifkmath@book
\kmath@amsthmtrue
\fi

\newif\ifkmath@novar
\kmath@novarfalse
\DeclareOption{novar}{\kmath@novartrue}

\newif\ifkmath@thm
\kmath@thmtrue
\DeclareOption{nothm}{\kmath@thmfalse}

\ProcessOptions\relax

\def\proofname{証明}

\ifkmath@thm
\RequirePackage{amsthm}
\ifkmath@amsthm%
\ifkmath@book%
\theoremstyle{definition}
\newtheorem{theorem}{定理}[chapter]
\newtheorem{definition}{定義}[chapter]
\newtheorem{lemma}{補題}[chapter]
\newtheorem{proposition}{命題}[chapter]
\newtheorem{corollary}{系}[chapter]
\newtheorem{assumption}{仮定}[chapter]
%\newtheorem{algorithm}{アルゴリズム}[chapter]
\else
\theoremstyle{definition}
\newtheorem{theorem}{定理}[section]
\newtheorem{definition}{定義}[section]
\newtheorem{lemma}{補題}[section]
\newtheorem{proposition}{命題}[section]
\newtheorem{corollary}{系}[section]
\newtheorem{assumption}{仮定}[section]
%\newtheorem{algorithm}{アルゴリズム}[section]
\fi
\else%
\newcommand{\ktheorems}[2]{%
\newcounter{#1}[section]
\expandafter\def\csname the#1\endcsname{\arabic{section}.\arabic{#1}}
\newenvironment{#1}[1][{　}]{%
\refstepcounter{#1}%
\bigskip\par%
\noindent%
\textbf{#2\csname the#1\endcsname}%
\ifx##1　
\hspace{1em}%
\else
\hspace{0.5em}%
(##1)%
\hspace{0.5em}%
\fi%
}{%
\bigskip\par%
}%
}%
\ktheorems{theorem}{定理}
\ktheorems{definition}{定義}
\ktheorems{lemma}{補題}
\ktheorems{proposition}{命題}
\ktheorems{corollary}{系}
\ktheorems{assumption}{仮定}
%\ktheorems{algorithm}{アルゴリズム}
\fi
\fi

\DeclareMathOperator{\sinc}{sinc}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\sn}{sn}
\DeclareMathOperator{\sint}{int}
\DeclareMathOperator{\cl}{cl}
\DeclareMathOperator{\bd}{bd}
\DeclareMathOperator{\aff}{aff}
\DeclareMathOperator{\ri}{ri}
\DeclareMathOperator{\co}{co}
\DeclareMathOperator{\epi}{epi}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator*{\argmin}{arg \thinspace min}
\DeclareMathOperator*{\argmax}{arg \thinspace max}
\DeclareMathOperator*{\minimize}{minimize\hspace{2em}}
\DeclareMathOperator*{\maximize}{maximize\hspace{2em}}
\let\Re\relax
\let\Im\relax
\DeclareMathOperator{\Re}{Re}
\DeclareMathOperator{\Im}{Im}
\DeclareMathOperator{\ulp}{ulp}
\DeclareMathOperator{\err}{err}

\def\setR{\mathbb{R}}
\def\setC{\mathbb{C}}
\def\calI{\mathcal{I}}
\def\iteI{\mathcal{I}}
\def\setPower{\mathcal{P}}
\def\calT{\mathcal{T}}
\def\calX{\mathcal{X}}
\def\calH{\mathcal{H}}
\def\setno{\varnothing}

\newcommand{\double}[1]{#1\!#1}

\ifkmath@novar
\else
\def\phi{\varphi}
\def\epsilon{\varepsilon}
\fi

\def\<{\langle}
\def\>{\rangle}

\ifkmath@many
\ifkmath@book
\renewcommand{\theequation}{%
\arabic{chapter}.\arabic{equation}%
}
\@addtoreset{equation}{chapter}
\else
\renewcommand{\theequation}{%
\arabic{section}.\arabic{equation}%
}
\@addtoreset{equation}{section}
\fi%book
\fi%many

\newcommand{\relmiddle}[1]{\mathrel{}\middle#1\mathrel{}}

\endinput
